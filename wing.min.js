const http=require("http"),fs=require("fs"),url=require("url"),path=require("path");class server{constructor(){this._stack=[],this.loc=process.cwd()}use(e,...t){"files"===e&&(this.files=path.join(this.loc,t[0]+"/"))}listen(e,t){return http.createServer(((e,t)=>{this.handle(e,t,(e=>{e&&(t.writeHead(500),t.end("Internal Server Error"))}))})).listen({port:e},t)}onGet(e,t){this._stack.push({loc:e,callback:t})}handle(e,t,r){for(var s=0;s<this._stack.length;s++){if(e.url===this._stack[s].loc){t.statusCode=200,t.setHeader("Content-Type","text/html"),t=i(t,this);let r={req:e,res:t};return this._stack[s].callback(r)}fs.readdir(this.files,((r,s)=>{r&&console.error(r);let i=s;for(var l=0;l<i.length;l++)e.url==="/"+i[l]?(t.statusCode=200,fs.readFile(this.files+i[l],(function(e,r){e&&console.error(e),t.end(r)}))):t.statusCode=404}))}function i(e,t){return e.send=function(e){this.end(e)},e.sendFile=function(e){let r=this;fs.readFile(t.loc+"/"+e,(function(e,t){e&&console.error(e),r.send(t)}))},e}}}module.exports.server=server;